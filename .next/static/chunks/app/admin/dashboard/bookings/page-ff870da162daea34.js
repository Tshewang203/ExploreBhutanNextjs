(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{5789:function(e,s,t){Promise.resolve().then(t.bind(t,1670))},1670:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var a=t(3827),i=t(4090),l=t(1126),r=t(7907),n=t(8009);function c(){let[e,s]=(0,i.useState)([]),[t,c]=(0,i.useState)(null),[d,x]=(0,i.useState)(!0),{data:o,status:m}=(0,l.useSession)(),p=(0,r.useRouter)();(0,i.useEffect)(()=>{"unauthenticated"===m?p.push("/admin/login"):"authenticated"===m&&h()},[m,p]);let h=async()=>{try{x(!0);let e=await fetch("/api/bookings"),t=await e.json();s(t)}catch(e){n.Am.error("Failed to fetch bookings")}finally{x(!1)}},u=async(e,s)=>{try{if((await fetch("/api/bookings/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})})).ok)n.Am.success("Booking status updated"),h();else throw Error("Failed to update")}catch(e){n.Am.error("Failed to update status")}},b=async e=>{if(confirm("Are you sure you want to delete this booking?"))try{if((await fetch("/api/bookings/".concat(e),{method:"DELETE"})).ok)n.Am.success("Booking deleted"),h(),(null==t?void 0:t._id)===e&&c(null);else throw Error("Failed to delete")}catch(e){n.Am.error("Failed to delete booking")}};return d?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[var(--dzong-blue)]"})}):(0,a.jsx)("div",{className:"min-h-screen bg-[var(--rice-white)]",children:(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-['Cinzel'] font-bold text-[var(--dzong-blue)]",children:"Booking Requests"}),(0,a.jsx)("div",{className:"h-1 w-32 bg-[var(--river-blue)] mt-2 rounded-full"})]}),(0,a.jsxs)("div",{className:"temple-card px-8 py-4 flex items-center gap-3",children:[(0,a.jsx)("i",{className:"bi bi-calendar-check text-2xl text-[var(--river-blue)]"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--mountain-slate)] block text-sm",children:"Total Bookings"}),(0,a.jsx)("span",{className:"text-2xl font-bold text-[var(--dzong-blue)]",children:e.length})]})]})]}),(0,a.jsx)("div",{className:"temple-card overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-[var(--dzong-blue)] text-[var(--text-white)]",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-['Cinzel'] uppercase tracking-wider",children:"Name"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-['Cinzel'] uppercase tracking-wider",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-['Cinzel'] uppercase tracking-wider",children:"Package"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-['Cinzel'] uppercase tracking-wider",children:"Dates"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-['Cinzel'] uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-['Cinzel'] uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-[var(--rice-white)] transition-all duration-200",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-person-circle text-[var(--river-blue)]"}),(0,a.jsx)("span",{className:"font-medium",children:"".concat(e.firstName," ").concat(e.lastName)})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-envelope text-[var(--mountain-slate)]"}),e.email]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-3 py-1 bg-[var(--rice-white)] text-[var(--dzong-blue)] rounded-full text-sm font-medium",children:e.tourPackage})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-[var(--mountain-slate)]",children:[(0,a.jsx)("i",{className:"bi bi-calendar-event"}),(0,a.jsxs)("span",{children:[new Date(e.arrivalDate).toLocaleDateString()," -"]}),(0,a.jsx)("span",{children:new Date(e.departureDate).toLocaleDateString()})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("select",{value:e.status,onChange:s=>u(e._id,s.target.value),className:"form-select ".concat("confirmed"===e.status?"bg-green-50 text-green-700":"cancelled"===e.status?"bg-red-50 text-red-700":"bg-yellow-50 text-yellow-700"),children:[(0,a.jsx)("option",{value:"pending",children:"⏳ Pending"}),(0,a.jsx)("option",{value:"confirmed",children:"✅ Confirmed"}),(0,a.jsx)("option",{value:"cancelled",children:"❌ Cancelled"})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>c(e),className:"btn-primary py-2 px-4 flex items-center gap-2 text-sm",children:[(0,a.jsx)("i",{className:"bi bi-eye"})," View"]}),(0,a.jsxs)("button",{onClick:()=>b(e._id),className:"bg-[var(--prayer-red)] text-white px-4 py-2 rounded-lg hover:opacity-90 transition-all flex items-center gap-2 text-sm",children:[(0,a.jsx)("i",{className:"bi bi-trash"})," Delete"]})]})})]},e._id))})]})}),t&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"booking-form max-w-4xl w-full mx-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold font-['Cinzel'] text-[var(--dzong-blue)]",children:"Booking Details"}),(0,a.jsx)("div",{className:"h-1 w-24 bg-[var(--river-blue)] mt-2 rounded-full"})]}),(0,a.jsx)("button",{onClick:()=>c(null),className:"text-[var(--mountain-slate)] hover:text-[var(--dzong-blue)] transition-colors text-2xl",children:(0,a.jsx)("i",{className:"bi bi-x-lg"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-8 bg-[var(--rice-white)] p-6 rounded-lg",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-person text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Name:"})," ",t.firstName," ",t.lastName]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-envelope text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Email:"})," ",t.email]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-globe text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Nationality:"})," ",t.nationality]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-credit-card text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Passport:"})," ",t.passportNumber]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-hash text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Booking Reference:"})," ",t.bookingRef]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-bag text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Package:"})," ",t.tourPackage]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-people text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Group Size:"})," ",t.adults," adults, ",t.children||0," children"]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-calendar-check text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Arrival:"})," ",new Date(t.arrivalDate).toLocaleDateString()]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-calendar-x text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Departure:"})," ",new Date(t.departureDate).toLocaleDateString()]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-tag text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Status:"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-sm ".concat("confirmed"===t.status?"bg-green-100 text-green-700":"cancelled"===t.status?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})]})]})]}),t.specialRequests&&(0,a.jsxs)("div",{className:"mt-6 bg-[var(--rice-white)] p-6 rounded-lg",children:[(0,a.jsxs)("p",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("i",{className:"bi bi-chat-left-text text-[var(--river-blue)]"}),(0,a.jsx)("strong",{children:"Special Requests:"})]}),(0,a.jsx)("p",{className:"text-[var(--mountain-slate)] pl-6",children:t.specialRequests})]}),(0,a.jsx)("div",{className:"mt-6 flex justify-end",children:(0,a.jsxs)("button",{onClick:()=>c(null),className:"btn-primary py-2 px-6 flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-x-circle"})," Close"]})})]})})]})})}}},function(e){e.O(0,[9,267,971,69,744],function(){return e(e.s=5789)}),_N_E=e.O()}]);