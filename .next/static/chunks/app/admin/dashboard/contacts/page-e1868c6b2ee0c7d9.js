(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[364],{7797:function(e,s,t){Promise.resolve().then(t.bind(t,248))},248:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var a=t(3827),r=t(4090),i=t(1126),l=t(7907),n=t(8009);function c(){let[e,s]=(0,r.useState)([]),[t,c]=(0,r.useState)(null),[d,o]=(0,r.useState)(!0),{data:m,status:x}=(0,i.useSession)(),u=(0,l.useRouter)();(0,r.useEffect)(()=>{"unauthenticated"===x?u.push("/admin/login"):"authenticated"===x&&h()},[x,u]);let h=async()=>{try{o(!0);let e=await fetch("/api/contact"),t=await e.json();s(t)}catch(e){n.Am.error("Failed to fetch messages")}finally{o(!1)}},p=async e=>{if(confirm("Are you sure you want to delete this message?"))try{if((await fetch("/api/contact/".concat(e),{method:"DELETE"})).ok)n.Am.success("Message deleted"),h();else throw Error("Failed to delete")}catch(e){n.Am.error("Failed to delete message")}},b=async e=>{try{if((await fetch("/api/contact/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"read"})})).ok)n.Am.success("Message marked as read"),h();else throw Error("Failed to update")}catch(e){n.Am.error("Failed to update message status")}};return d?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[var(--dzong-blue)]"})}):(0,a.jsx)("div",{className:"min-h-screen bg-[var(--rice-white)]",children:(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold font-['Cinzel'] text-[var(--dzong-blue)]",children:"Contact Messages"}),(0,a.jsx)("div",{className:"h-1 w-32 bg-[var(--river-blue)] mt-2 rounded-full"})]}),(0,a.jsxs)("div",{className:"temple-card px-8 py-4 flex items-center gap-3",children:[(0,a.jsx)("i",{className:"bi bi-envelope-paper text-2xl text-[var(--river-blue)]"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[var(--mountain-slate)] block text-sm",children:"Total Messages"}),(0,a.jsx)("span",{className:"text-2xl font-bold text-[var(--dzong-blue)]",children:e.length})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-6",children:[e.map(e=>(0,a.jsx)("div",{className:"temple-card p-6 transition-all duration-300 hover:-translate-y-1 ".concat("unread"===e.status?"border-l-4 border-[var(--river-blue)]":""),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("i",{className:"bi bi-chat-left-text text-[var(--river-blue)] text-xl"}),(0,a.jsx)("h2",{className:"text-xl font-semibold font-['Cinzel'] text-[var(--dzong-blue)]",children:e.subject}),"unread"===e.status&&(0,a.jsx)("span",{className:"px-3 py-1 bg-[var(--rice-white)] text-[var(--river-blue)] text-xs rounded-full font-medium",children:"New Message"})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-person text-[var(--mountain-slate)]"}),(0,a.jsx)("span",{className:"text-[var(--mountain-slate)] font-medium",children:e.name})]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bi bi-envelope text-[var(--mountain-slate)]"}),(0,a.jsx)("span",{className:"text-[var(--mountain-slate)]",children:e.email})]})]}),(0,a.jsx)("p",{className:"mt-4 text-[var(--text-dark)] bg-[var(--rice-white)] p-4 rounded-lg",children:e.message}),(0,a.jsxs)("p",{className:"flex items-center gap-2 text-sm text-[var(--mountain-slate)] mt-4",children:[(0,a.jsx)("i",{className:"bi bi-clock"}),"Received: ",new Date(e.createdAt).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex gap-3 ml-6",children:["unread"===e.status&&(0,a.jsxs)("button",{onClick:()=>b(e._id),className:"btn-primary py-2 px-4 flex items-center gap-2 text-sm group",children:[(0,a.jsx)("i",{className:"bi bi-check-circle group-hover:scale-110 transition-transform"}),"Mark as Read"]}),(0,a.jsxs)("button",{onClick:()=>p(e._id),className:"bg-[var(--prayer-red)] text-white px-4 py-2 rounded-lg hover:opacity-90 transition-all flex items-center gap-2 text-sm group",children:[(0,a.jsx)("i",{className:"bi bi-trash group-hover:scale-110 transition-transform"}),"Delete"]})]})]})},e._id)),0===e.length&&(0,a.jsxs)("div",{className:"temple-card p-12 text-center",children:[(0,a.jsx)("i",{className:"bi bi-inbox text-6xl text-[var(--mountain-slate)] mb-4"}),(0,a.jsx)("p",{className:"text-[var(--mountain-slate)] text-lg",children:"No messages received yet"})]})]})]})})}}},function(e){e.O(0,[9,267,971,69,744],function(){return e(e.s=7797)}),_N_E=e.O()}]);